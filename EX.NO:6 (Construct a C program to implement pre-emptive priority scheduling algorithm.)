#include <stdio.h>

int main() {
    int n, i, time = 0, smallest, count = 0, end;
    float avg_wt = 0, avg_tat = 0;

    printf("Enter number of processes: ");
    scanf("%d", &n);

    int at[n], bt[n], bt_rem[n], priority[n], wt[n], tat[n];

    for (i = 0; i < n; i++) {
        printf("\nEnter Arrival Time for P%d: ", i + 1);
        scanf("%d", &at[i]);
        printf("Enter Burst Time for P%d: ", i + 1);
        scanf("%d", &bt[i]);
        printf("Enter Priority for P%d (lower number = higher priority): ", i + 1);
        scanf("%d", &priority[i]);
        bt_rem[i] = bt[i];   // remaining burst time
    }

    priority[n] = 9999; // sentinel value

    printf("\nGantt Chart (Process Execution Order):\n");

    while (count != n) {
        smallest = n;
        for (i = 0; i < n; i++) {
            if (at[i] <= time && bt_rem[i] > 0 && priority[i] < priority[smallest]) {
                smallest = i;
            }
        }

        printf("P%d | ", smallest + 1);

        bt_rem[smallest]--;
        time++;

        if (bt_rem[smallest] == 0) {
            count++;
            end = time;
            tat[smallest] = end - at[smallest];
            wt[smallest] = tat[smallest] - bt[smallest];
        }
    }

    printf("\n\nProcess\tAT\tBT\tPriority\tWT\tTAT\n");
    for (i = 0; i < n; i++) {
        printf("P%d\t%d\t%d\t%d\t\t%d\t%d\n", i + 1, at[i], bt[i], priority[i], wt[i], tat[i]);
        avg_wt += wt[i];
        avg_tat += tat[i];
    }

    avg_wt /= n;
    avg_tat /= n;

    printf("\nAverage Waiting Time: %.2f", avg_wt);
    printf("\nAverage Turnaround Time: %.2f\n", avg_tat);

    return 0;
}
